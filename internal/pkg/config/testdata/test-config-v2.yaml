apiVersion: config/v2
kind: config

metadata:
  validateConfig: true
  scope:
    skip:
    - imports: testing
    - package: my/special/pkg

source:
- value:
    id: "Core Source"
    package: ^k8s.io/client-go/rest$
    type: ^TLSClientConfig$
    field: Password
- value:
    # `levee:”source”` should be default, but additional tags
    # should be configurable
    fieldtags:
      - myTag: source
      - myTag: otherSource
- call:
    id: "sensitive environment information"
    package: os
    function: getEnv
    arguments:
    - value:
        position: 0
        const: CFSSL_CA_PK_PASSWORD

sink:
- call:  &println-sink
    id: "don't print"
    package: fmt
    function: Println
    unless:
      - context:
          package: my/sanctioned/package
- value:
    id: "Sink function member"
    package: path/to/my/sinker/pkg
    type: MySinker
    field: SinkField

allowlist:
- call:
    <<: *println-sink                        # YAML Anchor expansion sets 'id', 'package', 'function', 'unless'
    id: "Ignore prints in third_party/pkg"   # overwrite 'id'
    context:                                 # add context
      package:  third_party/pkg
      function: falsePositiveProducer
- call:
    id: "Sink function member"
    context:
      package: path/to/my/sinker/pkg
      function: SafeSink
      receiver: MySinker
